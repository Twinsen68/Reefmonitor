# Ce fichier ajoute un champ et un bouton pour changer dynamiquement l’adresse I2C de la sonde ORP
# Il s’utilise uniquement temporairement pour éviter d’éditer manuellement la config ou débrancher la sonde

number:
  - platform: template
    name: "Changer adresse ORP"  # Champ pour saisir une nouvelle adresse I2C
    id: new_orp_address
    min_value: 1
    max_value: 127
    step: 1
    initial_value: 98  # Adresse actuelle par défaut (0x62)
    mode: box
    optimistic: true
    entity_category: "Config"
    web_server:
      sorting_group_id: sorting_group_orp  # Groupe visuel dans l'interface web

button:
  - platform: template
    name: "Appliquer nouvelle adresse ORP"  # Bouton pour appliquer le changement
    icon: mdi:network-outline
    id: orp_change_address_button
    on_press:
      then:
        - lambda: |-
            int addr = (int) id(new_orp_address).state;
            id(orp_ezo).send_custom("I2C," + to_string(addr));  // Envoie la commande de changement d'adresse
        - logger.log:
            format: "Changement d'adresse ORP demandé vers: %d"
            args: ["(int) id(new_orp_address).state"]
    web_server:
      sorting_group_id: sorting_group_orp  # Groupe visuel dans l'interface web